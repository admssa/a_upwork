node {
    def project = 'devsops-204802'
    def image_name = 'debian'

    stage('checkout') {
        checkout scm
    }

    stage('Build image') {
        image = docker.build("${project}/${image_name}", "-f ./vulnerability_scanning/Dockerfile .")
    }



    stage('Push image') {
      docker.withRegistry('https://eu.gcr.io', 'gcr:') {
        image.push("${BUILD_NUMBER}")
        image.push("latest")
      }
    }

}